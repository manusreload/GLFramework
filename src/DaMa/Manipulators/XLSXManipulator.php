<?php
/**
 * Created by PhpStorm.
 * User: manus
 * Date: 1/03/16
 * Time: 10:33
 */

namespace GLFramework\DaMa\Manipulators;


use GLFramework\Filesystem;
use TijsVerkoyen\CssToInlineStyles\Exception;

class XLSXManipulator extends ManipulatorCore
{

    /**
     * @var \SpreadsheetReader
     */
    var $reader;
    public function open($file, $config = array())
    {
        $fs = new Filesystem();
        $config['TempDir'] = $fs->getAbsolutePath();
        $this->reader = new \SpreadsheetReader_XLSX($file, $config);
    }

    public function next()
    {
        // TODO: Implement next() method.
        if($this->reader->valid())
            return array_map(array($this, 'map'), $this->reader->next());
        return false;
    }

    public function setSheet($index)
    {
        $this->reader->ChangeSheet($index);
        parent::setSheet($index); // TODO: Change the autogenerated stub
    }

    public function map($item)
    {
        return $item;
    }

}